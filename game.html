<!doctype html>

<html lang="en-us">

    <head>
        <meta charset="utf-8"/>
        <title>HackU-Server</title>

        <script src="libjs/Lib.js"></script>
        <script src="game/Worlds/baseWorld.js"></script>
        <script src="game/Worlds/testWorld.js"></script>
        <script src="game/Characters/baseChar.js"></script>
        <script src="game/Characters/testChar.js"></script>
        <script src="https://mmo-greenteam.rhcloud.com:8443/socket.io/socket.io.js"></script>
        <script src="/socket.io/socket.io.js"></script>
        <script src="game/multiplayer.js"></script>
    </head>

    <body style="overflow:hidden; padding:0; margin:0; ">

        <canvas id="loading-canvas" style="position:absolute;">
        </canvas>
        
        <canvas id="game-canvas" style="visibility:hidden; position:absolute;">
        </canvas>

        <script>
            window.onload = function () {
                var loadingCanvas = document.getElementById("loading-canvas");
                loadingCanvas.width = window.innerWidth;
                loadingCanvas.height = window.innerHeight;
                Lib().setCanvas(loadingCanvas);
                Lib("loader").sprite({ src: "game/Graphics/loading.png", size: [128, 128], frequency: 20, x: 'center', y: 'center'});

                var gameCanvas = document.getElementById("game-canvas");
                gameCanvas.width = window.innerWidth;
                gameCanvas.height = window.innerHeight;
                Lib().setCanvas(gameCanvas);

                // Get the player's world information here.
                var worldArray = [
                        0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1,
                        0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0,
                        1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0,
                        2, 0, 2, 0, 0, 2, 2, 2, 0, 1, 1, 0, 0,
                        2, 0, 2, 0, 0, 2, 3, 2, 0, 0, 0, 0, 0,
                        0, 0, 0, 3, 0, 2, 0, 2, 0, 1, 1, 0, 0,
                        0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0,
                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                        0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0,
                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                    ];


                var loadingCanvas = document.getElementById("loading-canvas");
                var gameCanvas = document.getElementById("game-canvas");
                loadingCanvas.style.visibility = "visible";
                gameCanvas.style.visibility = "hidden";

                loadWorld("testPlayer", "defaultRoom", 0, worldArray, 0, 0);

                Lib().load(function () {
                    socket.on('connect',function() {
                        if(charManager.mainChar.spawned) {
                            Lib("testChar").show();
                        }
                    });
                    
                    loadCharacter("testPlayer", 0, worldArray, 1100, 0);
                    socket.on('welcome',function() {
                        if(!charManager.mainChar.spawned) {
                            charManager.mainChar.spawned = true;
                            charManager.mainChar.object = Lib("testChar");
                            charManager.mainChar.data = {
                                id:charManager.mainChar.object.id,
                                x:charManager.mainChar.object.getX(),
                                y:charManager.mainChar.object.getY(),
                                size:charManager.mainChar.object.getSize()
                            };

                            console.log(charManager.mainChar.data.size);

                            socket.emit('playerData',charManager.mainChar.data);
                        }
                    });
                });

                var loadingCanvas = document.getElementById("loading-canvas");
                var gameCanvas = document.getElementById("game-canvas");
                loadingCanvas.style.visibility = "hidden";
                gameCanvas.style.visibility = "visible";
            }
        </script>

    </body>

</html>
